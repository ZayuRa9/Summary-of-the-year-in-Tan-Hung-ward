<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Quay Số Tết</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;font-family:Arial,Helvetica,sans-serif}
body{
  background:url("images/IM1.png") center/cover no-repeat fixed;
}

  display:flex;flex-direction:column;justify-content:space-between;
}

#main{
  position:relative;
  flex:1;
  overflow:hidden;
}

#number{
  position:absolute;
  left:50%;
  bottom:-30%;
  transform:translateX(-50%);
  font-size:18vw;
  font-weight:900;
  color:#ffd700;
  text-shadow:0 0 12px #000;
  transition:bottom .8s ease-out;
}

#number.show{
  bottom:35%;
}

#controls{
  position:absolute;
  bottom:18%;
  left:50%;
  transform:translateX(-50%);
}

.btn{
  padding:14px 36px;
  border-radius:20px;
  border:2px solid #ffd700;
  background:rgba(180,0,0,0.75);
  color:#ffd700;
  font-size:22px;
  cursor:pointer;
  transition:transform .1s;
}
.btn:active{transform:scale(.96)}

#results{
  padding:10px 24px;
  color:#ffd700;
  font-size:18px;
}

.row{display:flex;gap:16px;justify-content:center}
.row span:first-child{width:80px;font-weight:bold}

#backBtn{
  position:absolute;
  bottom:12px;left:12px;
  opacity:0;
  pointer-events:none;
}
body:hover #backBtn{
  opacity:1;
  pointer-events:auto;
}
</style>

</head>
<body>
<canvas id="fx"></canvas>

<div id="main">
  <div id="number">000</div>
</div>

<div id="controls">
  <button id="spinBtn" class="btn">Quay số</button>
</div>

<button id="backBtn" class="btn">Quay lại</button>

<div id="results"></div>

<div id="finalTable">
  <h1 style="margin-bottom:20px;color:#ffd700">KẾT QUẢ CHƯƠNG TRÌNH</h1>
  <table>
    <thead><tr><th>SỐ</th><th>GIẢI</th></tr></thead>
    <tbody id="finalBody"></tbody>
  </table>
</div>

<audio id="rollSound" src="roll.mp3" loop></audio>
<audio id="stopSound" src="stop.mp3"></audio>
<audio id="drumSound" src="drum.mp3"></audio>
<audio id="fireSound" src="firecracker.mp3"></audio>

<script>
const prizes = [
  ...Array(7).fill("Giải khuyến khích"),
  "Giải ba","Giải hai","Giải đặc biệt"
];

let pool = Array.from({length:400},(_,i)=>String(i+1).padStart(3,"0"));
let rolling=false, timer=null;
let results=[];
let prizeIndex=0;

const numEl=document.getElementById("number");
const resEl=document.getElementById("results");
const spinBtn=document.getElementById("spinBtn");
const backBtn=document.getElementById("backBtn");

function start(){
  if(rolling || prizeIndex>=prizes.length) return;
  rolling=true;
  numEl.classList.remove("show");
  timer=setInterval(()=>{
    const r=pool[Math.floor(Math.random()*pool.length)];
    numEl.textContent=r;
  },35);
}

function stop(){
  if(!rolling) return;
  clearInterval(timer);
  const idx=Math.floor(Math.random()*pool.length);
  const n=pool.splice(idx,1)[0];
  const prize=prizes[prizeIndex++];

  numEl.textContent=n;
  setTimeout(()=>numEl.classList.add("show"),50);

  results.push({n,prize});
  renderResults();
  rolling=false;
}

function toggle(){ rolling?stop():start(); }

function renderResults(){
  resEl.innerHTML=results.map(r=>`
    <div class="row">
      <span>${r.n}</span>
      <span>${r.prize}</span>
    </div>`).join("");
}

backBtn.onclick=()=>{
  if(results.length===0) return;
  const last=results[results.length-1];
  if(last.prize==="Giải đặc biệt") return;
  pool.push(last.n);
  results.pop();
  prizeIndex--;
  renderResults();
};

spinBtn.onclick=toggle;
document.addEventListener("keydown",e=>{
  if(e.code==="Space"){
    e.preventDefault();
    toggle();
  }
});
</script>

</body>
</html>



